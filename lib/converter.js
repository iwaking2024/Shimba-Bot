import{promises}from'fs';import{join}from'path';import{spawn}from'child_process';function ffmpeg(_0x3ebc92,_0x51862c=[],_0xf455c6='',_0x3b827a=''){return new Promise(async(_0x4b2196,_0x49bb69)=>{try{const _0x121133=join(global['__dirname'](import.meta['url']),'../tmp',+new Date()+'.'+_0xf455c6),_0x2e0dc6=_0x121133+'.'+_0x3b827a;await promises['writeFile'](_0x121133,_0x3ebc92),spawn('ffmpeg',['-y','-i',_0x121133,..._0x51862c,_0x2e0dc6])['on']('error',_0x49bb69)['on']('close',async _0x27ff87=>{try{await promises['unlink'](_0x121133);if(_0x27ff87!==0x0)return _0x49bb69(_0x27ff87);_0x4b2196({'data':await promises['readFile'](_0x2e0dc6),'filename':_0x2e0dc6,'delete'(){return promises['unlink'](_0x2e0dc6);}});}catch(_0x4f5700){_0x49bb69(_0x4f5700);}});}catch(_0x2dadc9){_0x49bb69(_0x2dadc9);}});}function toPTT(_0x4efe35,_0x4a888f){return ffmpeg(_0x4efe35,['-vn','-c:a','libopus','-b:a','128k','-vbr','on'],_0x4a888f,'ogg');}function toAudio(_0x3a7bf7,_0x56e455){return ffmpeg(_0x3a7bf7,['-vn','-c:a','libopus','-b:a','128k','-vbr','on','-compression_level','10'],_0x56e455,'opus');}function toVideo(_0x4b30c0,_0x5af78d){return ffmpeg(_0x4b30c0,['-c:v','libx264','-c:a','aac','-ab','128k','-ar','44100','-crf','32','-preset','slow'],_0x5af78d,'mp4');}export{toAudio,toPTT,toVideo,ffmpeg};