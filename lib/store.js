import{readFileSync,writeFileSync,existsSync}from'fs';const {initAuthCreds,BufferJSON,proto}=(await import('@whiskeysockets/baileys'))['default'];function bind(_0x443eef){if(!_0x443eef['chats'])_0x443eef['chats']={};function _0x3e11ae(_0x4e9e49){if(!_0x4e9e49)return;try{_0x4e9e49=_0x4e9e49['contacts']||_0x4e9e49;for(const _0x575058 of _0x4e9e49){const _0x375f25=_0x443eef['decodeJid'](_0x575058['id']);if(!_0x375f25||_0x375f25==='status@broadcast')continue;let _0x888286=_0x443eef['chats'][_0x375f25];if(!_0x888286)_0x888286=_0x443eef['chats'][_0x375f25]={..._0x575058,'id':_0x375f25};_0x443eef['chats'][_0x375f25]={..._0x888286,...{..._0x575058,'id':_0x375f25,..._0x375f25['endsWith']('@g.us')?{'subject':_0x575058['subject']||_0x575058['name']||_0x888286['subject']||''}:{'name':_0x575058['notify']||_0x575058['name']||_0x888286['name']||_0x888286['notify']||''}}||{}};}}catch(_0x3f86e8){console['error'](_0x3f86e8);}}_0x443eef['ev']['on']('contacts.upsert',_0x3e11ae),_0x443eef['ev']['on']('groups.update',_0x3e11ae),_0x443eef['ev']['on']('contacts.set',_0x3e11ae),_0x443eef['ev']['on']('chats.set',async({chats:_0x425dcc})=>{try{for(let {id:_0x14214f,name:_0x104bac,readOnly:_0x1f0301}of _0x425dcc){_0x14214f=_0x443eef['decodeJid'](_0x14214f);if(!_0x14214f||_0x14214f==='status@broadcast')continue;const _0x8a5e32=_0x14214f['endsWith']('@g.us');let _0x311887=_0x443eef['chats'][_0x14214f];if(!_0x311887)_0x311887=_0x443eef['chats'][_0x14214f]={'id':_0x14214f};_0x311887['isChats']=!_0x1f0301;if(_0x104bac)_0x311887[_0x8a5e32?'subject':'name']=_0x104bac;if(_0x8a5e32){const _0x3ff086=await _0x443eef['groupMetadata'](_0x14214f)['catch'](_0xe8b567=>null);if(_0x104bac||_0x3ff086?.['subject'])_0x311887['subject']=_0x104bac||_0x3ff086['subject'];if(!_0x3ff086)continue;_0x311887['metadata']=_0x3ff086;}}}catch(_0x26eb6c){console['error'](_0x26eb6c);}}),_0x443eef['ev']['on']('group-participants.update',async function _0xf2a089({id:_0x35a110,participants:_0x118976,action:_0x2f8793}){if(!_0x35a110)return;_0x35a110=_0x443eef['decodeJid'](_0x35a110);if(_0x35a110==='status@broadcast')return;if(!(_0x35a110 in _0x443eef['chats']))_0x443eef['chats'][_0x35a110]={'id':_0x35a110};const _0x2767dc=_0x443eef['chats'][_0x35a110];_0x2767dc['isChats']=!![];const _0x872fa1=await _0x443eef['groupMetadata'](_0x35a110)['catch'](_0x5b6566=>null);if(!_0x872fa1)return;_0x2767dc['subject']=_0x872fa1['subject'],_0x2767dc['metadata']=_0x872fa1;}),_0x443eef['ev']['on']('groups.update',async function _0x53f0f9(_0x59df38){try{for(const _0x29415f of _0x59df38){const _0x927b49=_0x443eef['decodeJid'](_0x29415f['id']);if(!_0x927b49||_0x927b49==='status@broadcast')continue;const _0x49c8e6=_0x927b49['endsWith']('@g.us');if(!_0x49c8e6)continue;let _0x38aeeb=_0x443eef['chats'][_0x927b49];if(!_0x38aeeb)_0x38aeeb=_0x443eef['chats'][_0x927b49]={'id':_0x927b49};_0x38aeeb['isChats']=!![];const _0x44c158=await _0x443eef['groupMetadata'](_0x927b49)['catch'](_0x496d7e=>null);if(_0x44c158)_0x38aeeb['metadata']=_0x44c158;if(_0x29415f['subject']||_0x44c158?.['subject'])_0x38aeeb['subject']=_0x29415f['subject']||_0x44c158['subject'];}}catch(_0x3c21e0){console['error'](_0x3c21e0);}}),_0x443eef['ev']['on']('chats.upsert',function _0x3453ac(_0x44314f){try{const {id:_0x1d348b,name:_0x24220d}=_0x44314f;if(!_0x1d348b||_0x1d348b==='status@broadcast')return;_0x443eef['chats'][_0x1d348b]={..._0x443eef['chats'][_0x1d348b]||{},..._0x44314f,'isChats':!![]};const _0x44f40d=_0x1d348b['endsWith']('@g.us');if(_0x44f40d)_0x443eef['insertAllGroup']()['catch'](_0x1da74f=>null);}catch(_0x1200c3){console['error'](_0x1200c3);}}),_0x443eef['ev']['on']('presence.update',async function _0x195fb1({id:_0x2dbd3b,presences:_0x15fb5f}){try{const _0x13962e=Object['keys'](_0x15fb5f)[0x0]||_0x2dbd3b,_0x20a7d6=_0x443eef['decodeJid'](_0x13962e),_0x415ee0=_0x15fb5f[_0x13962e]['lastKnownPresence']||'composing';let _0x30eb64=_0x443eef['chats'][_0x20a7d6];if(!_0x30eb64)_0x30eb64=_0x443eef['chats'][_0x20a7d6]={'id':_0x13962e};_0x30eb64['presences']=_0x415ee0;if(_0x2dbd3b['endsWith']('@g.us')){let _0x336a0f=_0x443eef['chats'][_0x2dbd3b];if(!_0x336a0f)_0x336a0f=_0x443eef['chats'][_0x2dbd3b]={'id':_0x2dbd3b};}}catch(_0xdc302b){console['error'](_0xdc302b);}});}const KEY_MAP={'pre-key':'preKeys','session':'sessions','sender-key':'senderKeys','app-state-sync-key':'appStateSyncKeys','app-state-sync-version':'appStateVersions','sender-key-memory':'senderKeyMemory'};function useSingleFileAuthState(_0x3b3030,_0x111010){let _0x40e20c,_0x19ed7f={},_0x4e32e8=0x0;const _0x560c16=_0x269432=>{_0x111010?.['trace']('saving\x20auth\x20state'),_0x4e32e8++,(_0x269432||_0x4e32e8>0x5)&&(writeFileSync(_0x3b3030,JSON['stringify']({'creds':_0x40e20c,'keys':_0x19ed7f},BufferJSON['replacer'],0x2)),_0x4e32e8=0x0);};if(existsSync(_0x3b3030)){const _0x6d7cc1=JSON['parse'](readFileSync(_0x3b3030,{'encoding':'utf-8'}),BufferJSON['reviver']);_0x40e20c=_0x6d7cc1['creds'],_0x19ed7f=_0x6d7cc1['keys'];}else _0x40e20c=initAuthCreds(),_0x19ed7f={};return{'state':{'creds':_0x40e20c,'keys':{'get':(_0x15e5de,_0x1547f0)=>{const _0x40dd12=KEY_MAP[_0x15e5de];return _0x1547f0['reduce']((_0x3adbab,_0x15c9f4)=>{let _0x2d558f=_0x19ed7f[_0x40dd12]?.[_0x15c9f4];return _0x2d558f&&(_0x15e5de==='app-state-sync-key'&&(_0x2d558f=proto['AppStateSyncKeyData']['fromObject'](_0x2d558f)),_0x3adbab[_0x15c9f4]=_0x2d558f),_0x3adbab;},{});},'set':_0x3274e8=>{for(const _0x1bf321 in _0x3274e8){const _0x5b0215=KEY_MAP[_0x1bf321];_0x19ed7f[_0x5b0215]=_0x19ed7f[_0x5b0215]||{},Object['assign'](_0x19ed7f[_0x5b0215],_0x3274e8[_0x1bf321]);}_0x560c16();}}},'saveState':_0x560c16};}function loadMessage(_0x190a26,_0x3a691f=null){let _0x23f78c=null;if(_0x190a26&&!_0x3a691f){_0x3a691f=_0x190a26;const _0x30fe71=_0x28b338=>_0x28b338['key']?.['id']==_0x3a691f,_0x2f3bb6={},_0x54bc5c=Object['entries'](_0x2f3bb6)['find'](([,_0xab9a44])=>{return _0xab9a44['find'](_0x30fe71);});_0x23f78c=_0x54bc5c?.[0x1]?.['find'](_0x30fe71);}else{_0x190a26=_0x190a26?.['decodeJid']?.();const _0x3668d0={};if(!(_0x190a26 in _0x3668d0))return null;_0x23f78c=_0x3668d0[_0x190a26]['find'](_0x43b55d=>_0x43b55d['key']['id']==_0x3a691f);}return _0x23f78c?_0x23f78c:null;}export default{'bind':bind,'useSingleFileAuthState':useSingleFileAuthState,'loadMessage':loadMessage};