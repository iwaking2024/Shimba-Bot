'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['default']=exports['constants']=void 0x0;const _fs2=_interopRequireDefault(require('fs')),_util=require('util'),_path=require('path');function _interopRequireDefault(_0x3d4ff8){return _0x3d4ff8&&_0x3d4ff8['__esModule']?_0x3d4ff8:{'default':_0x3d4ff8};}function asyncGeneratorStep(_0x33aa4d,_0x3ec06c,_0x25dd38,_0x40e49e,_0x286ce2,_0x44a135,_0x2f18b7){try{var _0x1257d6=_0x33aa4d[_0x44a135](_0x2f18b7),_0x5d5108=_0x1257d6['value'];}catch(_0x44f97d){_0x25dd38(_0x44f97d);return;}_0x1257d6['done']?_0x3ec06c(_0x5d5108):Promise['resolve'](_0x5d5108)['then'](_0x40e49e,_0x286ce2);}function _asyncToGenerator(_0x286630){return function(){const _0xcc3e94=this,_0x4be45c=arguments;return new Promise(function(_0x4259c5,_0xf491e4){const _0x198979=_0x286630['apply'](_0xcc3e94,_0x4be45c);function _0x10fd60(_0x7a8350){asyncGeneratorStep(_0x198979,_0x4259c5,_0xf491e4,_0x10fd60,_0x3e1583,'next',_0x7a8350);}function _0x3e1583(_0x1aaab4){asyncGeneratorStep(_0x198979,_0x4259c5,_0xf491e4,_0x10fd60,_0x3e1583,'throw',_0x1aaab4);}_0x10fd60(undefined);});};}function _defineProperty(_0x141e92,_0x52eac5,_0x553b47){return _0x52eac5 in _0x141e92?Object['defineProperty'](_0x141e92,_0x52eac5,{'value':_0x553b47,'enumerable':!![],'configurable':!![],'writable':!![]}):_0x141e92[_0x52eac5]=_0x553b47,_0x141e92;}function _classPrivateMethodGet(_0xf75f7e,_0x28e4a5,_0x2176d5){if(!_0x28e4a5['has'](_0xf75f7e))throw new TypeError('attempted\x20to\x20get\x20private\x20field\x20on\x20non-instance');return _0x2176d5;}const fs={'read':(0x0,_util['promisify'])(_fs2['default']['read']),'write':(0x0,_util['promisify'])(_fs2['default']['write']),'open':(0x0,_util['promisify'])(_fs2['default']['open']),'close':(0x0,_util['promisify'])(_fs2['default']['close'])},nullByte=Buffer['alloc'](0x1);nullByte[0x0]=0x0;const constants={'TYPE_LOSSY':0x0,'TYPE_LOSSLESS':0x1,'TYPE_EXTENDED':0x2};exports['constants']=constants;function VP8Width(_0x16a23a){const _0x27d822=_0x16a23a[0x7]<<0x8|_0x16a23a[0x6];return _0x27d822&0x3fff;}function VP8Height(_0x5da406){const _0x721d0=_0x5da406[0x9]<<0x8|_0x5da406[0x8];return _0x721d0&0x3fff;}function VP8LWidth(_0x1fa330){const _0x59ced3=_0x1fa330[0x2]<<0x8|_0x1fa330[0x1];return(_0x59ced3&0x3fff)+0x1;}function VP8LHeight(_0x57b358){let _0x2b4d35=_0x57b358[0x4]<<0x10|_0x57b358[0x3]<<0x8|_0x57b358[0x2];return _0x2b4d35=_0x2b4d35>>0x6,(_0x2b4d35&0x3fff)+0x1;}function doesVP8LHaveAlpha(_0x3b1bd9){return!!(_0x3b1bd9[0x4]&0x10);}function createBasicChunk(_0x2b7425,_0x496286){const _0x74736b=Buffer['alloc'](0x8),_0x122f85=_0x496286['length'];let _0x30db32;return _0x74736b['write'](_0x2b7425,0x0),_0x74736b['writeUInt32LE'](_0x122f85,0x4),_0x30db32=[_0x74736b,_0x496286],_0x122f85&0x1&&(_0x30db32[0x2]=nullByte),_0x30db32;}const _convertToExtended=new WeakSet(),_demuxFrame=new WeakSet(),_readHeader=new WeakSet(),_readChunkHeader=new WeakSet(),_readChunkHeader_buf=new WeakSet(),_readChunk_raw=new WeakSet(),_readChunk_VP=new WeakSet(),_readChunk_VP8_buf=new WeakSet(),_readChunk_VP8L=new WeakSet(),_readChunk_VP8L_buf=new WeakSet(),_readChunk_VP8X=new WeakSet(),_readChunk_ANIM=new WeakSet(),_readChunk_ANMF=new WeakSet(),_readChunk_ALPH=new WeakSet(),_readChunk_ALPH_buf=new WeakSet(),_readChunk_ICCP=new WeakSet(),_readChunk_EXIF=new WeakSet(),_readChunk_XMP=new WeakSet(),_readChunk_Skip=new WeakSet(),_read=new WeakSet();class Image{constructor(){_read['add'](this),_readChunk_Skip['add'](this),_readChunk_XMP['add'](this),_readChunk_EXIF['add'](this),_readChunk_ICCP['add'](this),_readChunk_ALPH_buf['add'](this),_readChunk_ALPH['add'](this),_readChunk_ANMF['add'](this),_readChunk_ANIM['add'](this),_readChunk_VP8X['add'](this),_readChunk_VP8L_buf['add'](this),_readChunk_VP8L['add'](this),_readChunk_VP8_buf['add'](this),_readChunk_VP['add'](this),_readChunk_raw['add'](this),_readChunkHeader_buf['add'](this),_readChunkHeader['add'](this),_readHeader['add'](this),_demuxFrame['add'](this),_convertToExtended['add'](this),_defineProperty(this,'data',null),_defineProperty(this,'loaded',![]),_defineProperty(this,'path','');}['clear'](){this['data']=null,this['path']='',this['loaded']=![];}get['width'](){if(!this['loaded'])return undefined;const _0x4cc1d5=this['data'];return _0x4cc1d5['extended']?_0x4cc1d5['extended']['width']:_0x4cc1d5['vp8l']?_0x4cc1d5['vp8l']['width']:_0x4cc1d5['vp8']?_0x4cc1d5['vp8']['width']:undefined;}get['height'](){if(!this['loaded'])return undefined;const _0x51cf36=this['data'];return _0x51cf36['extended']?_0x51cf36['extended']['height']:_0x51cf36['vp8l']?_0x51cf36['vp8l']['height']:_0x51cf36['vp8']?_0x51cf36['vp8']['height']:undefined;}get['type'](){return this['loaded']?this['data']['type']:undefined;}get['hasAnim'](){return this['loaded']?this['data']['extended']?this['data']['extended']['hasAnim']:![]:![];}get['anim'](){return this['hasAnim']?this['data']['anim']:undefined;}get['frameCount'](){return this['anim']?this['anim']['frameCount']:0x0;}get['iccp'](){return this['data']['extended']?this['data']['extended']['hasICCP']?this['data']['iccp']['raw']:undefined:undefined;}set['iccp'](_0x39264d){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0x39264d===undefined?(this['data']['extended']['hasICCP']=![],delete this['data']['iccp']):(this['data']['iccp']={'raw':_0x39264d},this['data']['extended']['hasICCP']=!![]);}get['exif'](){return this['data']['extended']?this['data']['extended']['hasEXIF']?this['data']['exif']['raw']:undefined:undefined;}set['exif'](_0x369d8d){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0x369d8d===undefined?(this['data']['extended']['hasEXIF']=![],delete this['data']['exif']):(this['data']['exif']={'raw':_0x369d8d},this['data']['extended']['hasEXIF']=!![]);}get['xmp'](){return this['data']['extended']?this['data']['extended']['hasXMP']?this['data']['xmp']['raw']:undefined:undefined;}set['xmp'](_0xa3b7d5){!this['data']['extended']&&_classPrivateMethodGet(this,_convertToExtended,_convertToExtended2)['call'](this),_0xa3b7d5===undefined?(this['data']['extended']['hasXMP']=![],delete this['data']['xmp']):(this['data']['xmp']={'raw':_0xa3b7d5},this['data']['extended']['hasXMP']=!![]);}['load'](_0x57bf0a){const _0x3babd9=this;return _asyncToGenerator(function*(){_0x3babd9['path']=_0x57bf0a,_0x3babd9['data']=yield _classPrivateMethodGet(_0x3babd9,_read,_read2)['call'](_0x3babd9,_0x57bf0a),_0x3babd9['loaded']=!![];})();}['demuxAnim'](_0x54107b,_0x306f79=-0x1,_0x1a5896='#FNAME#'){const _0xbb6b5d=this;return _asyncToGenerator(function*(){let _0x137fd6=0x0,_0x3ae538=_0xbb6b5d['frameCount'];if(_0x3ae538==0x0)throw new Error('This\x20WebP\x20isn\x27t\x20an\x20animation');_0x306f79!=-0x1&&(_0x137fd6=_0x3ae538=_0x306f79);for(let _0x5813d6=_0x137fd6;_0x5813d6<=_0x3ae538;_0x5813d6++){yield _classPrivateMethodGet(_0xbb6b5d,_demuxFrame,_demuxFrame2)['call'](_0xbb6b5d,(_0x54107b+'/'+_0x1a5896+'_'+_0x5813d6+'.webp')['replace'](/#FNAME#/g,(0x0,_path['basename'])(_0xbb6b5d['path'],'.webp')),_0xbb6b5d['anim']['frames'][_0x5813d6]);}})();}['replaceFrame'](_0x146a6e,_0x73d57d){const _0x4fe4ef=this;return _asyncToGenerator(function*(){if(!_0x4fe4ef['hasAnim'])throw new Error('WebP\x20isn\x27t\x20animated');if(_0x73d57d<0x0||_0x73d57d>=_0x4fe4ef['frameCount'])throw new Error('Frame\x20index\x20'+_0x73d57d+'\x20out\x20of\x20bounds\x20(0<=index<'+_0x4fe4ef['frameCount']+')');const _0x3301da=new Image();yield _0x3301da['load'](_0x146a6e);switch(_0x3301da['type']){case constants['TYPE_LOSSY']:case constants['TYPE_LOSSLESS']:break;case constants['TYPE_EXTENDED']:if(_0x3301da['hasAnim'])throw new Error('Merging\x20animations\x20not\x20currently\x20supported');break;default:throw new Error('Unknown\x20WebP\x20type');}switch(_0x4fe4ef['anim']['frames'][_0x73d57d]['type']){case constants['TYPE_LOSSY']:_0x4fe4ef['anim']['frames'][_0x73d57d]['vp8']['alpha']&&delete _0x4fe4ef['anim']['frames'][_0x73d57d]['alph'];delete _0x4fe4ef['anim']['frames'][_0x73d57d]['vp8'];break;case constants['TYPE_LOSSLESS']:delete _0x4fe4ef['anim']['frames'][_0x73d57d]['vp8l'];break;default:throw new Error('Unknown\x20frame\x20type');}switch(_0x3301da['type']){case constants['TYPE_LOSSY']:_0x4fe4ef['anim']['frames'][_0x73d57d]['vp8']=_0x3301da['data']['vp8'];break;case constants['TYPE_LOSSLESS']:_0x4fe4ef['anim']['frames'][_0x73d57d]['vp8l']=_0x3301da['data']['vp8l'];break;case constants['TYPE_EXTENDED']:if(_0x3301da['data']['vp8'])_0x4fe4ef['anim']['frames'][_0x73d57d]['vp8']=_0x3301da['data']['vp8'],_0x3301da['data']['vp8']['alpha']&&(_0x4fe4ef['anim']['frames'][_0x73d57d]['alph']=_0x3301da['data']['alph']);else _0x3301da['data']['vp8l']&&(_0x4fe4ef['anim']['frames'][_0x73d57d]['vp8l']=_0x3301da['data']['vp8l']);break;}_0x4fe4ef['anim']['frames'][_0x73d57d]['width']=_0x3301da['width'],_0x4fe4ef['anim']['frames'][_0x73d57d]['height']=_0x3301da['height'];})();}['muxAnim']({path:_0x11f316,bgColor:bgColor=[0xff,0xff,0xff,0xff],loops:loops=0x0}={}){const _0x474e83=this;return _asyncToGenerator(function*(){return Image['muxAnim']({'path':_0x11f316,'bgColor':bgColor,'loops':loops,'frames':_0x474e83['frames']});})();}static['muxAnim']({path:_0x42ff62,frames:_0x2685bd,width:width=0x0,height:height=0x0,bgColor:bgColor=[0xff,0xff,0xff,0xff],loops:loops=0x0,delay:delay=0x64,x:x=0x0,y:y=0x0,blend:blend=!![],dispose:dispose=![]}={}){return _asyncToGenerator(function*(){const _0x4700ab=Buffer['alloc'](0xc);let _0x332438=Buffer['alloc'](0x12);const _0x4df061=[];let _0x399bc2,_0xff6f12=![],_0x2bae74,_0x3f8f32=0x0,_0x1253f0=0x0;const _0x457cb6=width-0x1,_0x38c895=height-0x1;if(_0x2685bd['length']==0x0)throw new Error('No\x20frames\x20to\x20mux');else{if(_0x457cb6<=0x0||_0x457cb6>0x1<<0x18)throw new Error('Width\x20out\x20of\x20range');else{if(_0x38c895<=0x0||_0x38c895>0x1<<0x18)throw new Error('Height\x20out\x20of\x20range');else{if(_0x38c895*_0x457cb6>Math['pow'](0x2,0x20)-0x1)throw new Error('Width*height\x20too\x20large\x20('+_0x457cb6+',\x20'+_0x38c895+')');else{if(loops<0x0||loops>=0x1<<0x18)throw new Error('Loops\x20out\x20of\x20range');else{if(delay<0x0||delay>=0x1<<0x18)throw new Error('Delay\x20out\x20of\x20range');else{if(x<0x0||x>=0x1<<0x18)throw new Error('X\x20out\x20of\x20range');else{if(y<0x0||y>=0x1<<0x18)throw new Error('Y\x20out\x20of\x20range');}}}}}}}_0x4700ab['write']('RIFF',0x0),_0x4700ab['write']('WEBP',0x8),_0x332438['write']('VP8X',0x0),_0x332438['writeUInt32LE'](0xa,0x4),_0x332438[0x8]|=0x2;width!=0x0&&_0x332438['writeUIntLE'](_0x457cb6,0xc,0x3);height!=0x0&&_0x332438['writeUIntLE'](_0x38c895,0xf,0x3);_0x4df061['push'](_0x4700ab,_0x332438),_0x332438=Buffer['alloc'](0xe),_0x332438['write']('ANIM',0x0),_0x332438['writeUInt32LE'](0x6,0x4),_0x332438['writeUInt8'](bgColor[0x2],0x8),_0x332438['writeUInt8'](bgColor[0x1],0x9),_0x332438['writeUInt8'](bgColor[0x0],0xa),_0x332438['writeUInt8'](bgColor[0x3],0xb),_0x332438['writeUInt16LE'](loops,0xc),_0x4df061['push'](_0x332438);for(let _0x3645e9=0x0,_0x1a6a03=_0x2685bd['length'];_0x3645e9<_0x1a6a03;_0x3645e9++){const _0x3f523f=typeof _0x2685bd[_0x3645e9]['delay']==='undefined'?delay:_0x2685bd[_0x3645e9]['delay'],_0x11fda4=typeof _0x2685bd[_0x3645e9]['x']==='undefined'?x:_0x2685bd[_0x3645e9]['x'],_0x4458eb=typeof _0x2685bd[_0x3645e9]['y']==='undefined'?y:_0x2685bd[_0x3645e9]['y'],_0x2dd071=typeof _0x2685bd[_0x3645e9]['blend']==='undefined'?blend:_0x2685bd[_0x3645e9]['blend'],_0x49a850=typeof _0x2685bd[_0x3645e9]['dispose']==='undefined'?dispose:_0x2685bd[_0x3645e9]['dispose'];let _0x35039a=0x10,_0x14370c=!![],_0x18ed10;if(delay<0x0||delay>=0x1<<0x18)throw new Error('Delay\x20out\x20of\x20range\x20on\x20frame\x20'+_0x3645e9);else{if(x<0x0||x>=0x1<<0x18)throw new Error('X\x20out\x20of\x20range\x20on\x20frame\x20'+_0x3645e9);else{if(y<0x0||y>=0x1<<0x18)throw new Error('Y\x20out\x20of\x20range\x20on\x20frame\x20'+_0x3645e9);}}_0x332438=Buffer['alloc'](0x18),_0x332438['write']('ANMF',0x0),_0x332438['writeUIntLE'](_0x11fda4,0x8,0x3),_0x332438['writeUIntLE'](_0x4458eb,0xb,0x3),_0x332438['writeUIntLE'](_0x3f523f,0x14,0x3);!_0x2dd071&&(_0x332438[0x17]|=0x2);_0x49a850&&(_0x332438[0x17]|=0x1);_0x2685bd[_0x3645e9]['path']?(_0x399bc2=new Image(),yield _0x399bc2['load'](_0x2685bd[_0x3645e9]['path'])):_0x399bc2={'data':_0x2685bd[_0x3645e9]};_0x332438['writeUIntLE'](_0x399bc2['data']['width']-0x1,0xe,0x3),_0x332438['writeUIntLE'](_0x399bc2['data']['height']-0x1,0x11,0x3);switch(_0x399bc2['data']['type']){case constants['TYPE_LOSSY']:{const _0x3ba017=_0x399bc2['data']['vp8'];_0x3f8f32=_0x3ba017['width']>_0x3f8f32?_0x3ba017['width']:_0x3f8f32,_0x1253f0=_0x3ba017['height']>_0x1253f0?_0x3ba017['height']:_0x1253f0,_0x35039a+=_0x3ba017['raw']['length']+0x8,_0x18ed10=createBasicChunk('VP8\x20',_0x3ba017['raw']);}break;case constants['TYPE_LOSSLESS']:{const _0x28789f=_0x399bc2['data']['vp8l'];_0x3f8f32=_0x28789f['width']>_0x3f8f32?_0x28789f['width']:_0x3f8f32,_0x1253f0=_0x28789f['height']>_0x1253f0?_0x28789f['height']:_0x1253f0,_0x35039a+=_0x28789f['raw']['length']+0x8,_0x28789f['alpha']&&(_0xff6f12=!![]),_0x18ed10=createBasicChunk('VP8L',_0x28789f['raw']);}break;case constants['TYPE_EXTENDED']:if(_0x399bc2['data']['extended']['hasAnim']){const _0x2de989=_0x399bc2['data']['anim']['frames'];_0x14370c=![];_0x399bc2['data']['extended']['hasAlpha']&&(_0xff6f12=!![]);for(let _0x4a8c19=0x0,_0x5cc6b7=_0x2de989['length'];_0x4a8c19<_0x5cc6b7;_0x4a8c19++){_0x3f8f32=_0x2de989[_0x4a8c19]['width']+_0x11fda4>_0x3f8f32?_0x2de989[_0x4a8c19]['width']+_0x11fda4:_0x3f8f32,_0x1253f0=_0x2de989[_0x4a8c19]['height']+_0x4458eb>_0x1253f0?_0x2de989[_0x4a8c19]['height']+_0x4458eb:_0x1253f0;let _0xd07b2f=Buffer['alloc'](0x8);_0xd07b2f['write']('ANMF',0x0),_0xd07b2f['writeUInt32LE'](_0x2de989[_0x4a8c19]['raw']['length'],0x4),_0x4df061['push'](_0xd07b2f,_0x2de989[_0x4a8c19]['raw']),_0x2de989[_0x4a8c19]['raw']['length']&0x1&&_0x4df061['push'](nullByte),_0xd07b2f=_0x2de989[_0x4a8c19]['raw'],_0xd07b2f['writeUIntLE'](_0x11fda4,0x0,0x3),_0xd07b2f['writeUIntLE'](_0x4458eb,0x3,0x3),_0xd07b2f['writeUIntLE'](_0x3f523f,0xc,0x3),!_0x2dd071?_0xd07b2f[0xf]|=0x2:_0xd07b2f[0xf]&=0xfd,_0x49a850?_0xd07b2f[0xf]|=0x1:_0xd07b2f[0xf]&=0xfe;}}else{_0x3f8f32=_0x399bc2['data']['extended']['width']>_0x3f8f32?_0x399bc2['data']['extended']['width']:_0x3f8f32,_0x1253f0=_0x399bc2['data']['extended']['height']>_0x1253f0?_0x399bc2['data']['extended']['height']:_0x1253f0;if(_0x399bc2['data']['vp8'])_0x18ed10=[],_0x399bc2['data']['alph']&&(_0xff6f12=!![],_0x18ed10['push'](...createBasicChunk('ALPH',_0x399bc2['data']['alph']['raw'])),_0x35039a+=_0x399bc2['data']['alph']['raw']['length']+0x8),_0x18ed10['push'](...createBasicChunk('VP8\x20',_0x399bc2['data']['vp8']['raw'])),_0x35039a+=_0x399bc2['data']['vp8']['raw']['length']+0x8;else _0x399bc2['data']['vp8l']&&(_0x18ed10=createBasicChunk('VP8L',_0x399bc2['data']['vp8l']['raw']),_0x399bc2['data']['vp8l']['alpha']&&(_0xff6f12=!![]),_0x35039a+=_0x399bc2['data']['vp8l']['raw']['length']+0x8);}break;default:throw new Error('Unknown\x20image\x20type');}_0x14370c&&(_0x332438['writeUInt32LE'](_0x35039a,0x4),_0x4df061['push'](_0x332438,..._0x18ed10));}width==0x0&&_0x4df061[0x1]['writeUIntLE'](_0x3f8f32-0x1,0xc,0x3);height==0x0&&_0x4df061[0x1]['writeUIntLE'](_0x1253f0-0x1,0xf,0x3);_0x2bae74=0x4;for(let _0x257562=0x1,_0x3bb1d1=_0x4df061['length'];_0x257562<_0x3bb1d1;_0x257562++){_0x2bae74+=_0x4df061[_0x257562]['length'];}_0x4700ab['writeUInt32LE'](_0x2bae74,0x4);_0xff6f12&&(_0x4df061[0x1][0x8]|=0x10);const _0x5dcdc6=yield fs['open'](_0x42ff62,'w');for(let _0x173ccd=0x0,_0x43515a=_0x4df061['length'];_0x173ccd<_0x43515a;_0x173ccd++){yield fs['write'](_0x5dcdc6,_0x4df061[_0x173ccd],0x0,undefined,undefined);}yield fs['close'](_0x5dcdc6);})();}}var _convertToExtended2=function _convertToExtended2(){if(!this['loaded'])throw new Error('No\x20image\x20loaded');this['data']['type']=constants['TYPE_EXTENDED'],this['data']['extended']={'hasICC':![],'hasAlpha':![],'hasEXIF':![],'hasXMP':![],'width':this['vp8']?this['vp8']['width']:this['vp8l']?this['vp8l']['width']:0x1,'height':this['vp8']?this['vp8']['height']:this['vp8l']?this['vp8l']['height']:0x1};},_demuxFrame2=(function(){const _0x2d828d=_asyncToGenerator(function*(_0xa2f839,_0x58a06d){const _0x482b27=Buffer['alloc'](0xc);let _0x3625d7,_0x43f96d;const _0x4e8939=[];_0x482b27['write']('RIFF',0x0),_0x482b27['write']('WEBP',0x8),_0x4e8939['push'](_0x482b27);(this['data']['extended']['hasICC']||this['data']['extended']['hasEXIF']||this['data']['extended']['hasXMP']||_0x58a06d['vp8']&&_0x58a06d['vp8']['alpha'])&&(_0x43f96d=Buffer['alloc'](0x12),_0x43f96d['write']('VP8X',0x0),_0x43f96d['writeUInt32LE'](0xa,0x4),this['data']['extended']['hasICC']&&(_0x43f96d[0x8]|=0x20),(_0x58a06d['vp8l']&&_0x58a06d['vp8l']['alpha']||_0x58a06d['vp8']&&_0x58a06d['vp8']['alpha'])&&(_0x43f96d[0x8]|=0x10),this['data']['extended']['hasEXIF']&&(_0x43f96d[0x8]|=0x8),this['data']['extended']['hasXMP']&&(_0x43f96d[0x8]|=0x4),_0x43f96d['writeUIntLE'](_0x58a06d['width']-0x1,0xc,0x3),_0x43f96d['writeUIntLE'](_0x58a06d['height']-0x1,0xf,0x3),_0x4e8939['push'](_0x43f96d),this['data']['extended']['hasICC']&&_0x4e8939['push'](...createBasicChunk('ICCP',this['data']['extended']['icc']['raw'])));if(_0x58a06d['vp8l'])_0x4e8939['push'](...createBasicChunk('VP8L',_0x58a06d['vp8l']['raw']));else{if(_0x58a06d['vp8'])_0x58a06d['vp8']['alpha']&&_0x4e8939['push'](...createBasicChunk('ALPH',_0x58a06d['alph']['raw'])),_0x4e8939['push'](...createBasicChunk('VP8\x20',_0x58a06d['vp8']['raw']));else throw new Error('Frame\x20has\x20no\x20VP8/VP8L?');}this['type']==constants['TYPE_EXTENDED']&&(this['data']['extended']['hasEXIF']&&_0x4e8939['push'](...createBasicChunk('EXIF',this['data']['extended']['exif']['raw'])),this['data']['extended']['hasXMP']&&_0x4e8939['push'](...createBasicChunk('XMP\x20',this['data']['extended']['xmp']['raw'])));_0x3625d7=0x4;for(let _0x53bd74=0x1,_0x2d080e=_0x4e8939['length'];_0x53bd74<_0x2d080e;_0x53bd74++){_0x3625d7+=_0x4e8939[_0x53bd74]['length'];}_0x482b27['writeUInt32LE'](_0x3625d7,0x4);const _0x21b355=yield fs['open'](_0xa2f839,'w');for(let _0x1ee482=0x0,_0x3f3ade=_0x4e8939['length'];_0x1ee482<_0x3f3ade;_0x1ee482++){yield fs['write'](_0x21b355,_0x4e8939[_0x1ee482],0x0,undefined,undefined);}yield fs['close'](_0x21b355);});function _0x1dee06(_0x4125c3,_0x169d25){return _0x2d828d['apply'](this,arguments);}return _0x1dee06;}());const _readHeader2=(function(){const _0xa059b6=_asyncToGenerator(function*(_0x285e5f){const _0x2e5075=Buffer['alloc'](0xc),{bytesRead:_0x45b35e}=yield fs['read'](_0x285e5f,_0x2e5075,0x0,0xc,undefined);if(_0x45b35e!=0xc)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20header');if(_0x2e5075['toString']('utf8',0x0,0x4)!='RIFF')throw new Error('Bad\x20header\x20(not\x20RIFF)');if(_0x2e5075['toString']('utf8',0x8,0xc)!='WEBP')throw new Error('Bad\x20header\x20(not\x20WEBP)');return{'fileSize':_0x2e5075['readUInt32LE'](0x4)};});function _0x1db69b(_0x37726b){return _0xa059b6['apply'](this,arguments);}return _0x1db69b;}()),_readChunkHeader2=(function(){const _0x3b35eb=_asyncToGenerator(function*(_0x2a3f45){const _0x4a5062=Buffer['alloc'](0x8),{bytesRead:_0x4981f9}=yield fs['read'](_0x2a3f45,_0x4a5062,0x0,0x8,undefined);if(_0x4981f9==0x0)return{'fourCC':'\x00\x00\x00\x00','size':0x0};else{if(_0x4981f9<0x8)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20chunk\x20header');}return{'fourCC':_0x4a5062['toString']('utf8',0x0,0x4),'size':_0x4a5062['readUInt32LE'](0x4)};});function _0x28e0ef(_0x20cd0a){return _0x3b35eb['apply'](this,arguments);}return _0x28e0ef;}()),_readChunkHeader_buf2=function _readChunkHeader_buf2(_0x519ea4,_0xe00c48){if(_0xe00c48>=_0x519ea4['length'])return{'fourCC':'\x00\x00\x00\x00','size':0x0};return{'fourCC':_0x519ea4['toString']('utf8',_0xe00c48,_0xe00c48+0x4),'size':_0x519ea4['readUInt32LE'](_0xe00c48+0x4)};},_readChunk_raw2=(function(){const _0x304d87=_asyncToGenerator(function*(_0x279f8c,_0x4e88ad,_0x11acfa){const _0x4cf267=Buffer['alloc'](_0x11acfa),_0x5ad09f=Buffer['alloc'](0x1),{bytesRead:_0x16ec07}=yield fs['read'](_0x4e88ad,_0x4cf267,0x0,_0x11acfa,undefined);if(_0x16ec07!=_0x11acfa)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20'+_0x279f8c+'\x20chunk');return _0x11acfa&0x1&&(yield fs['read'](_0x4e88ad,_0x5ad09f,0x0,0x1,undefined)),{'raw':_0x4cf267};});function _0x21f85a(_0x4b2c66,_0x5dbc5d,_0x414923){return _0x304d87['apply'](this,arguments);}return _0x21f85a;}()),_readChunk_VP2=(function(){const _0x1ae83a=_asyncToGenerator(function*(_0x59919d,_0x402b28){const _0x4fbc6a=Buffer['alloc'](_0x402b28),_0x22bae8=Buffer['alloc'](0x1),{bytesRead:_0x3c993c}=yield fs['read'](_0x59919d,_0x4fbc6a,0x0,_0x402b28,undefined);if(_0x3c993c!=_0x402b28)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8\x20chunk');return _0x402b28&0x1&&(yield fs['read'](_0x59919d,_0x22bae8,0x0,0x1,undefined)),{'raw':_0x4fbc6a,'width':VP8Width(_0x4fbc6a,0x8),'height':VP8Height(_0x4fbc6a,0x8)};});function _0x25b987(_0xf6d20,_0x410558){return _0x1ae83a['apply'](this,arguments);}return _0x25b987;}()),_readChunk_VP8_buf2=function _readChunk_VP8_buf2(_0x3072f0,_0x4713ce,_0x4709a6){if(_0x4709a6>=_0x3072f0['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20VP8\x20chunk');const _0x1c42ba=_0x3072f0['slice'](_0x4709a6,_0x4709a6+_0x4713ce);return{'raw':_0x1c42ba,'width':VP8Width(_0x1c42ba),'height':VP8Height(_0x1c42ba)};},_readChunk_VP8L2=(function(){const _0x1f3ef8=_asyncToGenerator(function*(_0x8fa3c8,_0x322458){const _0x44a45f=Buffer['alloc'](_0x322458),_0x23b5c9=Buffer['alloc'](0x1),{bytesRead:_0x287084}=yield fs['read'](_0x8fa3c8,_0x44a45f,0x0,_0x322458,undefined);if(_0x287084!=_0x322458)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8L\x20chunk');return _0x322458&0x1&&(yield fs['read'](_0x8fa3c8,_0x23b5c9,0x0,0x1,undefined)),{'raw':_0x44a45f,'alpha':doesVP8LHaveAlpha(_0x44a45f,0x0),'width':VP8LWidth(_0x44a45f),'height':VP8LHeight(_0x44a45f)};});function _0x2c0daf(_0x5dda35,_0x9f294c){return _0x1f3ef8['apply'](this,arguments);}return _0x2c0daf;}()),_readChunk_VP8L_buf2=function _readChunk_VP8L_buf2(_0x47ef59,_0x2c8176,_0x136469){if(_0x136469>=_0x47ef59['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20VP8L\x20chunk');const _0x3b252b=_0x47ef59['slice'](_0x136469,_0x136469+_0x2c8176);return{'raw':_0x3b252b,'alpha':doesVP8LHaveAlpha(_0x3b252b),'width':VP8LWidth(_0x3b252b),'height':VP8LHeight(_0x3b252b)};},_readChunk_VP8X2=(function(){const _0x46220e=_asyncToGenerator(function*(_0x26c4d8,_0x43816b){const _0x2fc12f=Buffer['alloc'](_0x43816b),{bytesRead:_0x3d102f}=yield fs['read'](_0x26c4d8,_0x2fc12f,0x0,_0x43816b,undefined);if(_0x3d102f!=_0x43816b)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20VP8X\x20chunk');return{'raw':_0x2fc12f,'hasICC':!!(_0x2fc12f[0x0]&0x20),'hasAlpha':!!(_0x2fc12f[0x0]&0x10),'hasEXIF':!!(_0x2fc12f[0x0]&0x8),'hasXMP':!!(_0x2fc12f[0x0]&0x4),'hasAnim':!!(_0x2fc12f[0x0]&0x2),'width':_0x2fc12f['readUIntLE'](0x4,0x3)+0x1,'height':_0x2fc12f['readUIntLE'](0x7,0x3)+0x1};});function _0x3367bb(_0x40e54b,_0x4c5ee5){return _0x46220e['apply'](this,arguments);}return _0x3367bb;}()),_readChunk_ANIM2=(function(){const _0x3a9dc7=_asyncToGenerator(function*(_0x41117e,_0x272bfd){const _0x4cd114=Buffer['alloc'](_0x272bfd),{bytesRead:_0x5c2b74}=yield fs['read'](_0x41117e,_0x4cd114,0x0,_0x272bfd,undefined);if(_0x5c2b74!=_0x272bfd)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20ANIM\x20chunk');return{'raw':_0x4cd114,'bgColor':_0x4cd114['slice'](0x0,0x4),'loopCount':_0x4cd114['readUInt16LE'](0x4)};});function _0x585fb4(_0x95a580,_0x4b64d1){return _0x3a9dc7['apply'](this,arguments);}return _0x585fb4;}()),_readChunk_ANMF2=(function(){const _0x378a15=_asyncToGenerator(function*(_0x41a20b,_0x392ddf){const _0x5c8321=Buffer['alloc'](_0x392ddf),_0x397877=Buffer['alloc'](0x1),{bytesRead:_0x5a411d}=yield fs['read'](_0x41a20b,_0x5c8321,0x0,_0x392ddf,undefined);if(_0x5a411d!=_0x392ddf)throw new Error('Reached\x20end\x20of\x20file\x20while\x20reading\x20ANMF\x20chunk');_0x392ddf&0x1&&(yield fs['read'](_0x41a20b,_0x397877,0x0,0x1,undefined));const _0x520504={'raw':_0x5c8321,'x':_0x5c8321['readUIntLE'](0x0,0x3),'y':_0x5c8321['readUIntLE'](0x3,0x3),'width':_0x5c8321['readUIntLE'](0x6,0x3)+0x1,'height':_0x5c8321['readUIntLE'](0x9,0x3)+0x1,'duration':_0x5c8321['readUIntLE'](0xc,0x3),'blend':!(_0x5c8321[0xf]&0x2),'dispose':!!(_0x5c8321[0xf]&0x1)};let _0x55aeaf=!![],_0x59bde7=0x10;while(_0x55aeaf){const _0x53a334=_classPrivateMethodGet(this,_readChunkHeader_buf,_readChunkHeader_buf2)['call'](this,_0x5c8321,_0x59bde7);let _0x594aa4;_0x59bde7+=0x8;switch(_0x53a334['fourCC']){case'VP8\x20':!_0x520504['vp8']&&(_0x520504['type']=constants['TYPE_LOSSY'],_0x520504['vp8']=_classPrivateMethodGet(this,_readChunk_VP8_buf,_readChunk_VP8_buf2)['call'](this,_0x5c8321,_0x53a334['size'],_0x59bde7));break;case'VP8L':!_0x520504['vp8l']&&(_0x520504['type']=constants['TYPE_LOSSLESS'],_0x520504['vp8l']=_classPrivateMethodGet(this,_readChunk_VP8L_buf,_readChunk_VP8L_buf2)['call'](this,_0x5c8321,_0x53a334['size'],_0x59bde7));break;case'ALPH':_0x520504['vp8']&&(_0x520504['alph']=_classPrivateMethodGet(this,_readChunk_ALPH_buf,_readChunk_ALPH_buf2)['call'](this,_0x5c8321,_0x53a334['size'],_0x59bde7),_0x520504['vp8']['alpha']=!![]);break;case'\x00\x00\x00\x00':default:_0x55aeaf=![];break;}_0x59bde7+=_0x53a334['size']+0x1,_0x53a334['size']&0x1&&_0x59bde7++,_0x59bde7>=_0x5c8321['length']&&(_0x55aeaf=![]);}return _0x520504;});function _0x4dc14d(_0x49c784,_0x40c460){return _0x378a15['apply'](this,arguments);}return _0x4dc14d;}()),_readChunk_ALPH2=(function(){const _0x342e6b=_asyncToGenerator(function*(_0x17ecfa,_0x44e422){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'ALPH',_0x17ecfa,_0x44e422);});function _0x4eb1bc(_0x30573f,_0x175165){return _0x342e6b['apply'](this,arguments);}return _0x4eb1bc;}());var _readChunk_ALPH_buf2=function _readChunk_ALPH_buf2(_0x2891d2,_0x4e2823,_0xcafde1){if(cusor>=_0x2891d2['length'])throw new Error('Reached\x20end\x20of\x20buffer\x20while\x20reading\x20ALPH\x20chunk');return{'raw':_0x2891d2['slice'](_0xcafde1,_0xcafde1+_0x4e2823)};};const _readChunk_ICCP2=(function(){const _0x4c9a70=_asyncToGenerator(function*(_0x339d9c,_0x3d82fb){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'ICCP',_0x339d9c,_0x3d82fb);});function _0x274f03(_0x456581,_0x2b9460){return _0x4c9a70['apply'](this,arguments);}return _0x274f03;}()),_readChunk_EXIF2=(function(){const _0x16d82e=_asyncToGenerator(function*(_0x4e0de3,_0x5764b1){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'EXIF',_0x4e0de3,_0x5764b1);});function _0x2bbf05(_0x4d889a,_0x5e24f0){return _0x16d82e['apply'](this,arguments);}return _0x2bbf05;}()),_readChunk_XMP2=(function(){const _0x47c49b=_asyncToGenerator(function*(_0x19b2d3,_0x2a0143){return _classPrivateMethodGet(this,_readChunk_raw,_readChunk_raw2)['call'](this,'XML',_0x19b2d3,_0x2a0143);});function _0x30b5d6(_0xc7eeef,_0x1a8d73){return _0x47c49b['apply'](this,arguments);}return _0x30b5d6;}()),_readChunk_Skip2=(function(){const _0xa1e971=_asyncToGenerator(function*(_0x39ce31,_0x2fd28a){const _0xfd2c60=Buffer['alloc'](_0x2fd28a),_0x277358=Buffer['alloc'](0x1),{bytesRead:_0x3ae22d}=yield fs['read'](_0x39ce31,_0xfd2c60,0x0,_0x2fd28a,undefined);if(_0x3ae22d!=_0x2fd28a)throw new Error('Reached\x20end\x20of\x20file\x20while\x20skipping\x20chunk');_0x2fd28a&0x1&&(yield fs['read'](_0x39ce31,_0x277358,0x0,0x1,undefined));});function _0x24c1d1(_0x4b7568,_0x8b4f2d){return _0xa1e971['apply'](this,arguments);}return _0x24c1d1;}());var _read2=(function(){const _0x10acf3=_asyncToGenerator(function*(_0x402187){const _0x1c1fbe=yield fs['open'](_0x402187,'r'),_0x590e76={};let _0x3c6562=!![],_0x3b617b=!![];const {fileSize:_0x28ff2a}=yield _classPrivateMethodGet(this,_readHeader,_readHeader2)['call'](this,_0x1c1fbe);while(_0x3c6562){const {fourCC:_0x1be7d2,size:_0x2b6510}=yield _classPrivateMethodGet(this,_readChunkHeader,_readChunkHeader2)['call'](this,_0x1c1fbe);switch(_0x1be7d2){case'VP8\x20':!_0x590e76['vp8']?_0x590e76['vp8']=yield _classPrivateMethodGet(this,_readChunk_VP,_readChunk_VP2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);_0x3b617b&&(_0x590e76['type']=constants['TYPE_LOSSY'],_0x3c6562=![]);break;case'VP8L':!_0x590e76['vp8l']?_0x590e76['vp8l']=yield _classPrivateMethodGet(this,_readChunk_VP8L,_readChunk_VP8L2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);_0x3b617b&&(_0x590e76['type']=constants['TYPE_LOSSLESS'],_0x3c6562=![]);break;case'VP8X':!_0x590e76['extended']?(_0x590e76['type']=constants['TYPE_EXTENDED'],_0x590e76['extended']=yield _classPrivateMethodGet(this,_readChunk_VP8X,_readChunk_VP8X2)['call'](this,_0x1c1fbe,_0x2b6510)):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'ANIM':if(!_0x590e76['anim']){const {raw:_0x53b628,bgColor:_0x13bc44,loopCount:_0x19268e}=yield _classPrivateMethodGet(this,_readChunk_ANIM,_readChunk_ANIM2)['call'](this,_0x1c1fbe,_0x2b6510);_0x590e76['anim']={'backgroundColor':[_0x13bc44[0x2],_0x13bc44[0x1],_0x13bc44[0x0],_0x13bc44[0x3]],'loopCount':_0x19268e,'frames':[]},_0x590e76['anim']['raw']=_0x53b628;}else yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'ANMF':{const _0x2832a8=yield _classPrivateMethodGet(this,_readChunk_ANMF,_readChunk_ANMF2)['call'](this,_0x1c1fbe,_0x2b6510);_0x590e76['anim']['frames']['push'](_0x2832a8);}break;case'ALPH':!_0x590e76['alph']?_0x590e76['alph']=yield _classPrivateMethodGet(this,_readChunk_ALPH,_readChunk_ALPH2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'ICCP':!_0x590e76['iccp']?_0x590e76['iccp']=yield _classPrivateMethodGet(this,_readChunk_ICCP,_readChunk_ICCP2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'EXIF':!_0x590e76['exif']?_0x590e76['exif']=yield _classPrivateMethodGet(this,_readChunk_EXIF,_readChunk_EXIF2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'XMP\x20':!_0x590e76['xmp']?_0x590e76['xmp']=yield _classPrivateMethodGet(this,_readChunk_XMP,_readChunk_XMP2)['call'](this,_0x1c1fbe,_0x2b6510):yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;case'\x00\x00\x00\x00':_0x3c6562=![];break;default:yield _classPrivateMethodGet(this,_readChunk_Skip,_readChunk_Skip2)['call'](this,_0x1c1fbe,_0x2b6510);break;}_0x3b617b=![];}return _0x590e76['type']==constants['TYPE_EXTENDED']&&_0x590e76['extended']['hasAnim']&&(_0x590e76['anim']['frameCount']=_0x590e76['anim']['frames']['length']),_0x590e76;});function _0x331c84(_0x27015b){return _0x10acf3['apply'](this,arguments);}return _0x331c84;}());const _default={'TYPE_LOSSY':constants['TYPE_LOSSY'],'TYPE_LOSSLESS':constants['TYPE_LOSSLESS'],'TYPE_EXTENDED':constants['TYPE_EXTENDED'],'Image':Image};exports['default']=_default;